<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Test quickhull plasm</title>
  <link rel="stylesheet" href="../../styles/reset.css">
  <link rel="stylesheet" href="../../styles/style.css">
</head>
<body>

<!-- <canvas id="qh_demo" width="400" height="400" style="margin:20pt;border:solid 1px #888;"></canvas><br> -->
  <header>
    <h1 id="plasm-logo">Plasm.js</h1>
  </header>

  <div id="plasm"></div>
  
  <footer>
    <div id="plasm-stats"></div>
  </footer>

  <script src="../../support/three.js"></script>
  <script src="../../support/three-detector.js"></script>
  <script src="../../support/three-frame.js"></script>
  <script src="../../support/three-stats.js"></script>
  <script src="../../support/three-trackball.js"></script>
  <script src="../../node_modules/simplexn.js/lib/simplexn.js"></script>
  <script src="../../node_modules/f.js/lib/f.js"></script>
  <script src="../../lib/plasm.js"></script>
  <script src="../../lib/plasm-fun.js"></script>
  <script type="text/javascript" src="../quickhull.js"></script>
  <script type="text/javascript" src="../utils.js"></script>
  <script type="text/javascript">
  
  p = new Plasm('plasm', 'plasm-inspector');
  fun.PLASM(p);
  var points = [[0,0,0],[0,1,0],[1,0,0],[1,1,0],
                [0,0,1],[0,1,1],[1,0,1],[1,1,1]];//random3D(100, 20, 20, 20);//[[0, 4, 2], [-6, 0, 0], [4, -5, 0], [6, -4, 5], [0, 3, 1], [4, -2, 1], [-2, 5, 1], [-4, -2, 4], [4, 4, -5], [5, 0, 1], [-1, 0, -5], [-5, 2, 5], [2, 0, 2], [0, -3, 5], [4, -5, 0], [4, 4, 5], [1, -1, -6], [4, -4, -3], [1, 1, -6], [4, 4, -6]];//[[5, -5, 3], [0, 2, 1], [1, -1, 1], [2, -2, 3], [1, 0, 0]];//[[-1,-1,-1],[1,0,0],[0,1,0],[0,0,1], [1,1,1], [1,1,0]];
  // IN ERRORE 
  // OK [[0, 4, 2], [-6, 0, 0], [4, -5, 0], [6, -4, 5], [0, 3, 1], [4, -2, 1], [-2, 5, 1], [-4, -2, 4], [4, 4, -5], [5, 0, 1], [-1, 0, -5], [-5, 2, 5], [2, 0, 2], [0, -3, 5], [4, -5, 0], [4, 4, 5], [1, -1, -6], [4, -4, -3], [1, 1, -6], [4, 4, -6]];
  // OK [[0, -6, -1], [1, 0, -6], [-3, 2, -6], [5, 4, 3], [-6, -6, -1], [-1, -5, -6], [-2, -6, -2], [0, 6, 6], [1, 5, 5], [0, -5, 6], [-4, -5, -2], [-4, 3, 1], [3, 0, 5], [3, -4, -2], [-2, 3, -5], [-5, -4, -3], [3, -1, -4], [-2, 5, 2], [1, -4, 4], [5, 0, -2]]
  // OK [[0, 6, -6], [-3, 1, -2], [6, 3, 1], [1, 3, 6], [-4, 0, -1], [0, 3, 3], [5, -2, 5], [2, 1, 6], [1, 1, -1], [1, 4, -6], [-5, 6, 0], [3, -6, -4], [1, 3, -3], [2, -3, -4], [-3, 6, -6], [2, 2, 1], [6, -2, -2], [4, -6, -6], [1, 0, 5], [6, 6, 0], [5, -3, -1], [1, 4, -2], [-1, -1, 6], [1, 6, -3], [3, -6, -1], [-3, -5, -5], [-5, 1, -6], [-5, -4, 4], [4, -1, 3], [-4, 0, 1], [2, -1, -1], [-2, 2, 0], [0, 3, -1], [-1, 6, 3], [1, 2, 3], [2, -1, 4], [6, -5, -5], [6, 5, 1], [1, -5, -3], [1, 1, -1], [0, -5, -4], [-1, -5, -4], [-2, -3, 3], [-1, -3, -5], [0, -4, 0], [-5, 6, 6], [-4, -4, 0], [0, -6, 2], [5, 0, 2], [-1, 4, 2]]
  // OK [[3.4973238913800153, 8.434147723119578, 2.914648150959218], [7.678910375497571, -5.780374704549055, 2.42248795131255], [0.2777045578187254, -8.210533375266987, -5.646131100054834], [-5.830922421657371, -9.478532169473498, -2.745829681695815], [-6.009253041922889, 9.786189694947021, -2.5516906292799444], [-9.725056253788196, -0.23802421629362303, 4.746771541199275], [9.520387100197649, 0.5417380397681559, 0.5119053826808317], [5.781984773255807, -3.177675148120337, 7.070602032808199], [2.62989348727261, 1.1085207626896265, -0.33798888083305334], [7.784987296587338, 2.933749297298691, -0.17349343195430467], [6.473078771030556, 0.0027955730345763374, -5.510155309659969], [-0.07305819308910388, -3.1464084765275144, 8.300044886692579], [-0.3358666183384651, -1.5956652346166555, -0.16007498827621092], [1.6310878523311079, -5.529917462358931, 8.679007913313754], [-6.828318348362256, -4.194557472774014, 9.37694710739586], [-7.569731962171915, 9.291677382635376, -7.584102208075139], [0.2857048770706483, -4.474963812536666, 3.2858599998257554], [-4.262975710710127, 5.346798657584937, 2.994723965259621], [4.279387556541021, 4.901539059111819, 0.6537501935077539], [-5.124286912601973, 9.394073867873141, -4.616742597849727], [-9.05141710251994, -2.1155485538344667, 8.022407229201221], [5.652646483379984, 3.475846044520561, 3.986466406068571], [-0.5558914840653062, 6.541044286951432, 6.549619580602009], [-8.967631988641996, -7.138412343028798, -0.28125165932069374], [-9.596758251572048, 6.675040906110695, -0.8586916194213234], [6.578122099181903, -6.741240486035318, -1.2981214237808159], [2.2958891048745644, 5.67735428865551, -2.253204177392557], [3.5920837080714474, 4.832417656269291, 3.837149088934156], [1.8068899320668108, -2.9636529843332493, -2.648032334593214], [-2.975284608237727, 0.8143918399716754, -3.4392500510125124], [-5.8092571556711325, 9.530667211658177, -5.4992743539205255], [9.80467875200122, 9.368208728645065, -0.07842204216882975], [4.87412194855564, -2.705386900800719, 5.8848854830664665], [3.7375881494419314, -4.286079772967133, 3.99635899174089], [3.2869784077169206, 3.910476356825341, 3.6944521910980432], [-6.13070607429529, -2.4812701393742964, 4.392756378732424], [6.3444173495996665, -1.8760149255302894, -1.630683316529734], [7.393333032429589, -6.000924592727687, -3.147517798909364], [6.511039448337005, -3.5030750017374745, 3.406832789437375], [0.24714570405439007, 8.861594950746683, 6.15145934939151], [-5.129355572704561, 5.297528805365117, 7.143411353275716], [5.590192627874643, -0.45887535602674223, -6.160005925523179], [6.619626551882259, -9.942873201078255, 4.5241866882071875], [9.625702941985715, -8.171687166134408, -3.3597549560518325], [8.288233121056418, 5.168747948453632, -7.765606268439482], [3.816676048621913, 8.58840031178226, 3.0506814047976594], [-0.9823064690166805, 5.597216959960213, -3.88542692699966], [3.0651246025730594, 9.526114338013311, -3.9971459199460124], [-3.884996144637267, -2.7117702575415747, 9.125464732837095], [2.2902194761755768, -3.696070289247444, -6.088756097639923]]
  //random3D(6, 7, 7, 7);
  //[[-6, -3, 5], [0, -5, 6], [-4, 6, 2], [4, -2, 1], [-1, -1, -1]];
  //getRandomPoints3D(5,10, 10, 10);
  //[[129, 149, 30], [115, 205, 85], [169, 207, 87], [318, 179, 258], [306, 238, 246], [371, 174, 312]];
  //[[5, -5, 3], [0, 2, 1], [1, -1, 1], [2, -2, 3], [1, 0, 0]]
  //var points = getRandomPoints2D(5,5,5);
  //var points = getRandomPoints2D(50,399,399);//[[148, 41], [150, 299], [36, 211], [338, 237], [316, 178], [338, 207], [250, 250]];
             /*[[1.48, 4.1], 
                [1.50, 2.99], 
                [3.6, 2.11], 
                [3.38, 2.37], 
                [3.16, 1.78], 
                [3.38, 2.07], 
                [2.50, 2.50]];*///getRandomPoints2D(50,399,399);
  //[[10, 10], [390, 10], [200, 350], [200, 340], [250, 340]];//
  console.log(points);

  var pointsPlasm = new Array();

  var black = [0,0,0];

  var cells = new Array();

  var punto;

  for ( var i = 0; i < points.length; i++) {
  	
  	punto = new Array();
  	for ( var j = 0; j < points[i].length; j++) {
  		punto.push(points[i][j]);
  	}

  	pointsPlasm.push(punto);
  	
  	cells.push([i]);
  }

  //console.log(cells);

  var s0 = SIMPLICIAL_COMPLEX(pointsPlasm)(cells);
  var cs0 = COLOR(black)(s0);

  DRAW(cs0);

  var structArr = new Array();
  structArr.push(cs0);

  var convexHull = quickhull.quickhull(points, 2);
  var vertices = convexHull.vertices;
  var faccia, verticiPlasm;
  var facets = convexHull.facets;
/*
  for ( var i = 0; i < facets.length; i++) {
  	vertices = facets[i].vertices;
  	
  	if (facets[i].topoOriented) {
		cells = [[1,0,2]];
	} else {
		cells = [[0,1,2]];
	}

  	//faccia = COLOR([0,1,0,0.4])(SIMPLICIAL_COMPLEX(verticiPlasm)([[0,1],[1,2],[2,0]/*[0,1,2]]));
	faccia = COLOR([0,1,0,0.5])(SIMPLICIAL_COMPLEX(vertices)([[0,1,2]]));  	
  	//structArr.push(faccia);
  	DRAW(STRUCT([COLOR([0,0,0,0.5])(SKELETON(1)(faccia)), faccia]));
  }*/
  cells = convHullToPlasm(vertices, facets)
  //console.log(convHullToPlasm(convexHull.vertices, convexHull.facets));
  convSimpl = SIMPLICIAL_COMPLEX(convexHull.vertices)(cells);
  DRAW(STRUCT([COLOR([0,0,0,0.5])(SKELETON(1)(convSimpl)),COLOR([0,1,0,0.5])(convSimpl)]));
  </script>
</body>
</html>